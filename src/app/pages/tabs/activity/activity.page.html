<ion-content [scrollEvents]="true" parallax-page>
    <div class="profile-header scrollable">
        <span (click)="openNotification()" class="notification-content">
            <img src="../../../../assets/svg/home/notification.svg" alt="Icon">
            <div *ngIf="userData != null && userData.notificationCount > 0" class="badge-notification">
                {{ userData.notificationCount }}
            </div>
        </span>
        <div class="profile-container ion-text-center">
            <div class="profile-inner">
                <div class="avatar">
                    <div class="avatar-image">
                        <img [src]="userData == null ? '../../../../assets/svg/home/avatar.png' : userData.profilePictureUrl"
                            alt="">
                    </div>
                </div>
                <div class="profile-info">
                    <div class="ion-margin-bottom profile-name">
                        <span>{{userData == null? '&nbsp;' : userData.fullName}}</span>
                    </div>
                    <div class="d-flex ion-justify-content-center">
                        <div (click)="openCreate()"
                            class="round-badge mr-2 d-flex ion-justify-content-center ion-align-items-center">
                            <img src="../../../../assets/svg/abstract/add.svg" alt="Icon">
                        </div>
                        <div class="round-badge ml-2 d-flex ion-justify-content-center ion-align-items-center">
                            <img src="../../../../assets/svg/abstract/search.svg" alt="Icon">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="content main">

        <div>
            <div class="d-flex ion-padding-horizontal ion-align-items-center ion-justify-content-between mb-4 mt-4">
                <div class="date-info">
                    {{viewTitle}}
                </div>
                <div>
                    <button class="month-today-button" ion-button [disabled]="isToday" (click)="today()">Bugün</button>
                </div>
            </div>
            <calendar [eventSource]="eventSource" [calendarMode]="calendar.mode" [currentDate]="calendar.currentDate"
                [monthviewEventDetailTemplate]="detailTemplate" (onCurrentDateChanged)="onCurrentDateChanged($event)"
                (onEventSelected)="onEventSelected($event)" (onTitleChanged)="onViewTitleChanged($event)"
                (onTimeSelected)="onTimeSelected($event)" [step]="calendar.step" noEventsLabel="Etkinlik bulunamadı"
                allDayLabel="">
            </calendar>
        </div>

        <div style="min-height: 500px;">
            <h1 class="px-3">
                <img src="../../../../assets/svg/activity/upcoming.svg" alt="Icon" style="margin-bottom: -6px">

                Yaklaşan Etkinlikler
            </h1>

            <ion-list class="activity-list" *ngIf="upcomingEvents">
                <ion-item *ngFor="let activity of upcomingEvents" (click)="openEdit(activity)">
                    <span class="activity-date">{{ activity.startTime | date: 'dd/MM/yyyy' }}</span>
                    <span class="dot"></span>
                    <span class="activity-title">{{ activity.title }}</span>
                </ion-item>
            </ion-list>

            <div class="px-3 text-2" *ngIf="upcomingEvents == null">
                Yaklaşan etkinlik bulunamadı.
            </div>
        </div>

    </div>
</ion-content>

<ng-template #detailTemplate let-showEventDetail="showEventDetail" let-selectedDate="selectedDate"
    let-noEventsLabel="noEventsLabel">
    <ion-list class="activity-list" *ngIf="selectedDate.hasEvent">
        <ion-item *ngFor="let activity of selectedDate.events" (click)="openEdit(activity)">
            <span class="activity-date">{{ activity.startTime | date: 'dd/MM/yyyy' }}</span>
            <span class="dot"></span>
            <span class="activity-title">{{ activity.title }}</span>
        </ion-item>
    </ion-list>
</ng-template>